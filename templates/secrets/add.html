{% extends "base.html" %}

{% block title %}Nieuwe Secret Toevoegen - Secret Manager{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>Nieuwe Secret Toevoegen</h1>
        <a href="{{ url_for('secrets.list') }}" class="btn btn-outline">‚Üê Terug naar lijst</a>
    </div>

    <div class="form-container">
        <form method="POST" class="secret-form">
            <div class="form-group">
                <label for="name" class="required">Naam</label>
                <input type="text" 
                       id="name" 
                       name="name" 
                       required 
                       placeholder="Bijv. Gmail wachtwoord, API sleutel, etc."
                       value="{{ request.form.name if request.form.name }}">
                <small class="form-help">Geef je secret een herkenbare naam</small>
            </div>

            <div class="form-group">
                <label for="category">Categorie</label>
                <select id="category" name="category">
                    <option value="">Selecteer categorie (optioneel)</option>
                    <option value="Wachtwoord" {{ 'selected' if request.form.category == 'Wachtwoord' }}>Wachtwoord</option>
                    <option value="API Sleutel" {{ 'selected' if request.form.category == 'API Sleutel' }}>API Sleutel</option>
                    <option value="Database" {{ 'selected' if request.form.category == 'Database' }}>Database</option>
                    <option value="SSH Sleutel" {{ 'selected' if request.form.category == 'SSH Sleutel' }}>SSH Sleutel</option>
                    <option value="Token" {{ 'selected' if request.form.category == 'Token' }}>Token</option>
                    <option value="Certificaat" {{ 'selected' if request.form.category == 'Certificaat' }}>Certificaat</option>
                    <option value="Overig" {{ 'selected' if request.form.category == 'Overig' }}>Overig</option>
                </select>
            </div>

            <div class="form-group">
                <label for="description">Beschrijving</label>
                <textarea id="description" 
                          name="description" 
                          rows="3" 
                          placeholder="Optionele beschrijving van deze secret">{{ request.form.description if request.form.description }}</textarea>
            </div>

            <div class="form-group">
                <label for="secret_value" class="required">Secret Waarde</label>
                <textarea id="secret_value" 
                          name="secret_value" 
                          required 
                          rows="4" 
                          placeholder="Voer hier je gevoelige informatie in">{{ request.form.secret_value if request.form.secret_value }}</textarea>
                <small class="form-help">Dit is de daadwerkelijke geheime informatie</small>
            </div>

            <!-- Encryption Section -->
            <div class="encryption-section">
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" 
                               id="use_encryption" 
                               name="use_encryption" 
                               onchange="toggleEncryption()"
                               {{ 'checked' if request.form.use_encryption }}>
                        <span class="checkmark"></span>
                        Encryptie gebruiken voor extra beveiliging
                    </label>
                </div>

                <div id="encryption-password" class="form-group" style="display: none;">
                    <label for="password">Encryptie Wachtwoord</label>
                    <input type="password" 
                           id="password" 
                           name="password" 
                           placeholder="Voer een sterk wachtwoord in voor encryptie">
                    <small class="form-help">
                        <strong>Belangrijk:</strong> Onthoud dit wachtwoord goed! 
                        Zonder dit wachtwoord kun je je secret niet meer lezen.
                    </small>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Secret Opslaan</button>
                <a href="{{ url_for('secrets.list') }}" class="btn btn-outline">Annuleren</a>
            </div>
        </form>
    </div>

    <!-- Help Section -->
    <div class="help-section">
        <h3>üí° Tips voor veilige secrets</h3>
        <ul>
            <li><strong>Gebruik sterke wachtwoorden:</strong> Combineer letters, cijfers en symbolen</li>
            <li><strong>Encryptie:</strong> Gebruik encryptie voor extra gevoelige informatie</li>
            <li><strong>Categorie√´n:</strong> Organiseer je secrets met categorie√´n voor overzicht</li>
            <li><strong>Beschrijvingen:</strong> Voeg context toe zodat je later weet waarvoor de secret is</li>
        </ul>
    </div>
</div>

<script>
function toggleEncryption() {
    const checkbox = document.getElementById('use_encryption');
    const passwordField = document.getElementById('encryption-password');
    
    if (checkbox.checked) {
        passwordField.style.display = 'block';
        document.getElementById('password').required = true;
    } else {
        passwordField.style.display = 'none';
        document.getElementById('password').required = false;
        document.getElementById('password').value = '';
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    toggleEncryption();
});
</script>
{% endblock %}